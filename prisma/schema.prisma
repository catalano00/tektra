generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider  = "postgresql"
  url       = env("DATABASE_URL")
  directUrl = env("DIRECT_URL")
}

model Project {
  id        String      @id @default(cuid())
  name      String      @unique
  client    String
  components Component[]
}

enum Process {
  Cut
  Assemble
  Fly
  Ship
}

enum Status {
  pending
  complete
  paused
}

model TimeEntry {
  id          String    @id @default(cuid())
  componentId String
  component   Component @relation(fields: [componentId], references: [id])
  warehouse   String
  workstation String
  teamLead    String
  process     Process
  status      Status    // NEW: pending or complete
  duration    Float     // in minutes
  createdAt   DateTime  @default(now())
}

model Component {
  id                  String       @id
  componentType       String
  currentStatus       String
  lastCompletedProcess String?     // NEW: last completed operation (e.g., "Cut")
  nextProcess         String?      // NEW: the next operation to be performed
  processStatus       String?      // NEW: text summary like "In Production (Cut)"
  percentComplete     Int?         // NEW: percent of total process complete
  totalCycleTime      Float?       // NEW: total time in minutes for all complete entries
  completedAt         DateTime?    // when marked complete
  designUrl           String?
  workstation         String?      // NEW: last used workstation
  teamLead            String?      // NEW: last team lead
  projectId           String
  project             Project      @relation(fields: [projectId], references: [id])
  partList            Part[]       // Assembly parts
  sheathing           Sheathing?   // Sheathing schedule
  timeEntries         TimeEntry[]
}

model Part {
  id           String   @id @default(cuid())
  componentId  String
  component    Component @relation(fields: [componentId], references: [id])
  label        String
  size         String
  count        Int
  cutLength    String
}

model Sheathing {
  id           String   @id @default(cuid())
  componentId  String   @unique
  component    Component @relation(fields: [componentId], references: [id])
  panelArea    String
  panelCount   Float
}
